# Example: tls test
    
=== "Topology"
    
     <div class="nextWrapper">
         <iframe src="/guides/reference/snippets/next-diagram.html" style="border:none;"></iframe>
     </div>

    
=== "Configuration"
    
    **r1:**
    ```
    hostname r1
    buggy
    !
    logging file debug ../binTmp/zzz72r1-log.run
    !
    crypto rsakey rsa import $v10$TUlJRW93SUJBQUtDQVFFQWlmcm8wOWJhVkxVSkFwNHJKL1drVEIwOTloVVVNK01JVHA0RnVQck5JbkU2aWh6NmcxbjdiNkhPUjZJRFo4Q2d1TzNzcVlhRDBMZHN2by9nVWFBaFFOQzhlaTZWVUYrSTU2QlZXRUJrUVcrUk16eTdtWktsNVZ3dFNJT0krNGZYbXlGdkJOalBVYmJES1RTSTdHTTZka25mZ0NFbzVXT3pLK2FXS0ZZaHdORlZoWHdSVWh0YXBMVks4UXRRY1FCTUtCOWNxMDRndFdEbVBBVTdWUjNUVit3Q09wUjVLcHFkaXp3bCtMbklUQ2JVR0Y3OUt5a2xIcGU0cTY2cERQK1B3dlJvRDdLUXJXaHFkOVFLN3g0K3dJa1hUamdib2QrR09BRDIrSi9HWGY4Sm1UdE42L1ZKdE9zOFZQZzhZMm9iamwvbjB2VXhCVUptb2E2WDBZTUUxd0lEQVFBQkFvSUJBRUZNNWZPYnN5aHpwUmdBRXh5T1BIdHBPM0hDK0JTMlZiQWZTVVlLTEJzb3l6T2lFMDBtd01CTUszdnJTUUZKUU1kRWtzU0lUTW55aFJ5S3F2YjJlY1piQTFndnc2cU9EQlRTNUpFbnFFcnZxaUE5bGV0UVpBTHdaTjMwb2xlb0tubllrTm9TWWN1aVd5cWRHbEFGaGgyRlNLa3pDRS9IcDN3WFhPa3FHajlPSHR6TVg1NnIxT002LzR2SmExV05hN3BBTjVNdWVUbGpKQ3FjOGlPRUtERFhJbE9VQUhaK2RSRHVyeGJBcG93QzVLWWtRSTRqamZlVWZVWDZ1U1Nub21ZMnkzV3pPeXFmd05YN3RuMU5Rd0Y0Z1VXVktrZGFqSzVDYm15OHdRSTNFbm9yK1hLaXJJNStvWnFQYzVKTXNnWlJrOXR0VG5Ec1RKbklHb0NJRllFQ2dZRUEydDVOMTJ5OVpoazVzc0YzcWhQSk13WE1nRUgwZUVDcmpDc2M1NGxOZnNhb3ZKMzV0ZW54b2x4Nm1kckVheFA2M3BwNlZNYXFtY3ltTHErSkMyM3lURG5MYmppQ24rM0x6YnR1cm1DenZCTDJGQng5c29sVWpmVzlma3ZZQUNkMWNWbmg2dXhkZ05HU3dOSklvdndSczl2T2ZEYzEraTYxTzFvQS9FaUVPTjhDZ1lFQW9XT0o1KzFVQlhUVjFjMWhyQTBkTkNTckVBVHZIVlMyc1UrUHJONE5ZTDNucVZ5QXRwN0RLbmNwRlRlbGZWWjN3YVk2K0diV1paZEJWR24wb055bTI4RHlLQ2dtd1VwUlR4cFIySHl3WGoxY0RYSGJTM29Za2w0QThLaTU3UzN6N2xkRDFMYmNBRFpBNktZaXRLanBUbUlNRmtGNVJjYU1xVWdxNWVGU213a0NnWUVBeHozUUJ1Z0trc01yN3pxSHdPQTZMS1Ird2ROSXhaKzVpdVJFYjlKaUphS2JRUGxldE9lKy9GckxrUHZDQ3VncFhET3NZVGhwWFpFYlJ5eXN5U2JSaCtxazhqV25WQWVabkRPZ1VrWGQyTHc2SDV6QUlLTTd3ZStQRFVYbDRGNExYNkMvTktqdmhiRkNzeDI2MmdRMTZWR1Q2eWduanhTdUR0V2tTQVdMdUdrQ2dZQnRUdUhFdURYRVRGSFlzWGFKOVlmbUhUL1BaY2dlY1pZYm1ldVNCZ1BCbGw0bGs0V0tLeFc4MldCMkFtNlA2ZFRLMEMvNHRvNVgySTVqQWpDeUUwRGdibHFWWUR4L2hqcHovVHVhQ1RuYldtdlNuMThNUy9JQWtMTEtUVDFBcTNNZjV2TUdTNlBPY1BDZG9vaTNIQUNKR2xkZGE1TWI4MUtxQlRzbzMrZjNJUUtCZ0NJMlROQVpzNDkweEc3SWwxV0V5dGdpL0l0YklVQ25KZXBJendlYzR6ZGxyTVBObHpOa2RxNSs0UW1URU8vaEY2b1VVdElnbDdIdUVGQmdzNkcwa2FDTldqZHJ1dU5sNSs4NU5SeE9WK1NVQkdpdlZhellxamtWTEtaY2oyUXR6eUhVcFRmTDV5YUxnOXN2WWV6a1F2aGFXa2dBeGVkdDlHNVhjN1d3S0c3YQ==
    !
    crypto dsakey dsa import $v10$TUlJQnV3SUJBQUtCZ1FDMVMvdG15Q0t3bGt6czl0OG9zMkFaUVkwblI0eTltckVjSmQvSUdXMXJzMzlOUVhHdWtYY2ZweWtmUWNJL2czT3V2S0FqdzMzeXF1QXZDWlNobCt3aGorODl1bGRHWnNFWklnOFNCZVc2Z24vMys0NG9wM0tDUVVTVWRmU25mSDMvYlRNa3ZTWWFLd25CWlYxUG1qUlNzTy9jYll2dE5aSHVBd0hOLzF0NTN3SVZBTkN5Qy9SajhTeUZUQ0xuMEduK0hVdUtJUU0zQW9HQkFKT0I0eGVlN1ZGUlBGeHc3SXhUcE5HNm1xeDZiampWTHl0djlWNTV2MFo5UWVOU3FMSndkWU9nUGpaa1RDTVcvcFdWcVZTNkJXdzVsR0pNZEJSaDNCaFdSeUJUdXZJWnFYUXlBNmtycXJtQlk3SytuWnppUFJHcmNTbXNiN2pUdDFGOENmczFVcmJtVnlaQVg2V3dsTGFVUmlLNERIU1U3QUlBTS9DTXBLbDVBb0dBSk44dm9kaWhDWlF1M2xjY096cDN2WVNad01Ca3JQRVhRN1J2NXo2cm1WNEw3MEZLODV3c05SUEYyS0M5ZmpHQzBOamdFOGNoVWhLS3NqYXdCWDlWdG9zK0xTbm9QcFJMUFdYOU9kK09XQmlKMkE5MkhTOUFHTFRPWFdpdHRESkpDOGlXclhBS2Q1TXhDYS9QWnM5Yi9SSXVDbjVRamRCOVZBZ3N0QVFsVG5vQ0ZDVjdPSndnR1VySzEvK2ovaUtjcURnVGJzZjE=
    !
    crypto ecdsakey ecdsa import $v10$TUhNQ0FRRUVIeGFPMHZad0ljRHZlS2xoc28wd05MUGxyYkxBYzZUa0NDY3dyT1JWbE9tZ0J3WUZLNEVFQUFxaFJBTkNBQVIvMENDeURXU0x6SjlXb2VlZkVzOS9ML2d3R0crVEMvWUpUZVVnZ1FQcWQrOHV2NWJjNHR2UDNPWkJ2aDcyR25LdU5OWWhBbCtPRVBrdktpNHZxQnBN
    !
    crypto certificate dsa import dsa dsa $v10$TUlJQ1ZUQ0NBaEdnQXdJQkFnSUVFdStqVWpBTEJnY3Foa2pPT0FRREJRQXdEVEVMTUFrR0ExVUVBeE1DY2pFd0hoY05Nakl3TlRBeU1qRXhORFV4V2hjTk16SXdOREk1TWpFeE5EVXhXakFOTVFzd0NRWURWUVFERXdKeU1UQ0NBYmN3Z2dFc0JnY3Foa2pPT0FRQk1JSUJId0tCZ1FDMVMvdG15Q0t3bGt6czl0OG9zMkFaUVkwblI0eTltckVjSmQvSUdXMXJzMzlOUVhHdWtYY2ZweWtmUWNJL2czT3V2S0FqdzMzeXF1QXZDWlNobCt3aGorODl1bGRHWnNFWklnOFNCZVc2Z24vMys0NG9wM0tDUVVTVWRmU25mSDMvYlRNa3ZTWWFLd25CWlYxUG1qUlNzTy9jYll2dE5aSHVBd0hOLzF0NTN3SVZBTkN5Qy9SajhTeUZUQ0xuMEduK0hVdUtJUU0zQW9HQkFKT0I0eGVlN1ZGUlBGeHc3SXhUcE5HNm1xeDZiampWTHl0djlWNTV2MFo5UWVOU3FMSndkWU9nUGpaa1RDTVcvcFdWcVZTNkJXdzVsR0pNZEJSaDNCaFdSeUJUdXZJWnFYUXlBNmtycXJtQlk3SytuWnppUFJHcmNTbXNiN2pUdDFGOENmczFVcmJtVnlaQVg2V3dsTGFVUmlLNERIU1U3QUlBTS9DTXBLbDVBNEdFQUFLQmdDVGZMNkhZb1FtVUx0NVhIRHM2ZDcyRW1jREFaS3p4RjBPMGIrYytxNWxlQys5QlN2T2NMRFVUeGRpZ3ZYNHhndERZNEJQSElWSVNpckkyc0FWL1ZiYUxQaTBwNkQ2VVN6MWwvVG5mamxnWWlkZ1BkaDB2UUJpMHpsMW9yYlF5U1F2SWxxMXdDbmVUTVFtdnoyYlBXLzBTTGdwK1VJM1FmVlFJTExRRUpVNTZNQXNHQnlxR1NNNDRCQU1GQUFNeEFBQXdMUUlVZEZjQ0R5RDdsbW1WREN1SVRnYkVHUzhueG9nQ0ZRQ09zM29sZ2xQd21qSDJ3c1hKUkwzWjM1RW9TZz09
    !
    crypto certificate ecdsa import ecdsa ecdsa $v10$TUlJQlRUQ0JzS0FEQWdFQ0FnUUw3Sm5yTUF3R0NDcUdTTTQ5QkFNQ0JRQXdEVEVMTUFrR0ExVUVBeE1DY2pFd0hoY05Nakl3TlRBeU1qRXhORFV4V2hjTk16SXdOREk1TWpFeE5EVXhXakFOTVFzd0NRWURWUVFERXdKeU1UQlhNQkFHQnlxR1NNNDlBZ0VHQlN1QkJBQUtBME1BQUFSLzBDQ3lEV1NMeko5V29lZWZFczkvTC9nd0dHK1RDL1lKVGVVZ2dRUHFkKzh1djViYzR0dlAzT1pCdmg3MkduS3VOTlloQWwrT0VQa3ZLaTR2cUJwTU1Bd0dDQ3FHU000OUJBTUNCUUFEZ1lrQUFEQ0JoQUloQUlpSEhNUlM5N1F4SHpPdnNBWVE3UDlva3d2V1gwYXdaKzFuMHB4eTZTQTVBbDhLSTBkVVo2WTNIMmp6SGFSQTl0YWM5dW5LU25IU0hPcmdVeFBGNTdUcC94QkwyQ01RNHRTVmR1V2xWdERXb3NKSmlsL0pLamhvejV6RnpHTkFvZUdWSURPeEIwSWdMUDZaeVppYWREcUdoMVVFTFkzSEp0aWRSOHM3cnp6NndnPT0=
    !
    crypto certificate rsa import rsa rsa $v10$TUlJQ2xqQ0NBWDZnQXdJQkFnSUVCTjFZU0RBTkJna3Foa2lHOXcwQkFRc0ZBREFOTVFzd0NRWURWUVFERXdKeU1UQWVGdzB5TWpBMU1ESXlNVEUwTlRGYUZ3MHpNakEwTWpreU1URTBOVEZhTUEweEN6QUpCZ05WQkFNVEFuSXhNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQWlmcm8wOWJhVkxVSkFwNHJKL1drVEIwOTloVVVNK01JVHA0RnVQck5JbkU2aWh6NmcxbjdiNkhPUjZJRFo4Q2d1TzNzcVlhRDBMZHN2by9nVWFBaFFOQzhlaTZWVUYrSTU2QlZXRUJrUVcrUk16eTdtWktsNVZ3dFNJT0krNGZYbXlGdkJOalBVYmJES1RTSTdHTTZka25mZ0NFbzVXT3pLK2FXS0ZZaHdORlZoWHdSVWh0YXBMVks4UXRRY1FCTUtCOWNxMDRndFdEbVBBVTdWUjNUVit3Q09wUjVLcHFkaXp3bCtMbklUQ2JVR0Y3OUt5a2xIcGU0cTY2cERQK1B3dlJvRDdLUXJXaHFkOVFLN3g0K3dJa1hUamdib2QrR09BRDIrSi9HWGY4Sm1UdE42L1ZKdE9zOFZQZzhZMm9iamwvbjB2VXhCVUptb2E2WDBZTUUxd0lEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQjF3RzJCL1poMTVNcEJybng4b2ZWRTlaKzM0UEh2OVJaeThjTUNoeXZCbmw4bEs2UTNBZ2w0ZVkxMVpsb2NnbXRYSVdzTm4wMTRHTnhjTktmT2lIVy9DM2hjM0YvcTNNSWxlVXh1SlRFOGxMNnRJaGVzR3c4bUhwMnpXdHk5M1psM1JESFArMktqSTBUVlBnMEx2Q1JtRnJyZ2trK2RFQzZCSUZ4OUdpZHQvYzBZclpVWnRYaHhMb3JHTkxseGE4VGM4ck1ta3VsTk9Sb1A2SzFtWFkzZVdUUFowTVZNV1FLMVlpK0JQeVU1cndvRGRRQ0VIUWFiTVl4V2lqY3Q5UDEwVjh5WVVZL2diQ2JwU21KMHZBQ0hGVlBwaGFnVHNTN09VeEx6eSs2OTlzMVV2NUcvWk8zdUJOUVhIWTl6M1oxdDYvNHBuRUQrMXJ1S2Q3ME1mNDEv
    !
    vrf definition tester
     exit
    !
    vrf definition v1
     rd 1:1
     exit
    !
    interface loopback0
     vrf forwarding v1
     ipv4 address 2.2.2.2 255.255.255.255
     no shutdown
     no log-link-change
     exit
    !
    interface ethernet1
     vrf forwarding v1
     ipv4 address 1.1.1.1 255.255.255.0
     ipv6 address 1234::1 ffff::
     no shutdown
     no log-link-change
     exit
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    server telnet tel
     security protocol tls
     security rsakey rsa
     security dsakey dsa
     security ecdsakey ecdsa
     security rsacert rsa
     security dsacert dsa
     security ecdsacert ecdsa
     port 666
     no exec authorization
     no login authentication
     vrf v1
     exit
    !
    server telnet tester
     security protocol telnet
     no exec authorization
     no login authentication
     vrf tester
     exit
    !
    !
    end
    ```
    
    **r2:**
    ```
    hostname r2
    buggy
    !
    logging file debug ../binTmp/zzz72r2-log.run
    !
    vrf definition tester
     exit
    !
    vrf definition v1
     rd 1:1
     exit
    !
    interface ethernet1
     vrf forwarding v1
     ipv4 address 1.1.1.2 255.255.255.0
     ipv6 address 1234::2 ffff::
     no shutdown
     no log-link-change
     exit
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    !
    server telnet tester
     security protocol telnet
     no exec authorization
     no login authentication
     vrf tester
     exit
    !
    !
    end
    ```
